---
title: "How to Manufacture Your Personality to Gain Friends and Second Dates: A Data-Driven Field Guide for Pathetic People by Pathetic People"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Group members: Beau, Richard, Saad, Kevin

```{r}
library(data.table)
```


# Importing the data
(credit: Beau and Richard)

Speed Dating dataset: https://www.kaggle.com/annavictoria/speed-dating-experiment

Each row of the data represents one date. The primary key is one of the participants in the date, so for each date there are two rows in the dataset.

We imported the data, and then turned the appropriate columns into factors. Missing data were just blank strings, which we encoded as NAs.

For now, we are filtering out rows which do not have complete data (some participants did not include their hometown or undergraduate school, which were used as proxies to quantify wealth and education level). We are probably going to add these partially-full rows back into our analysis as we drop features from our model.

```{r}
project.dir <- getwd()
setwd(project.dir)
file_names <- list.files(file.path(project.dir), pattern="*.csv", full.names=TRUE) 
data1 <- fread(file.path(file_names))


data1[,c("race_o","field_cd", "race", "goal", "date", "go_out", "career_c", "met", "dec", "length", "numdat_2", "gender", "condtn")]<-lapply(data1[,c("race_o","field_cd", "race", "goal", "date", "go_out", "career_c", "met", "dec", "length", "numdat_2", "gender", "condtn")], factor)

#income, tuition, and mn_sat have NA values so they aren't numeric

nrow(data1[complete.cases(data1[ , c("income","tuition","mn_sat")]),])
nrow(data1)

#we could look at subset? is there a reason that people left off this information?

#data1 <- nrow(data1[complete.cases(data1[ , c("income")]),])
#nrow(data1[complete.cases(data1[ , c("mn_sat", "income")]),])
#nrow(data1[complete.cases(data1[ , c("tuition", "income")]),])

```


# Predicting rate of people liking you with constant fields
(credit: Beau and Richard)


The variable 'dec_o' encodes whether the other person in the date decided they would like a second date with you (1 for yes, 0 for no). We decided to use this as the response variable instead of 'match' because 'match' means that both people mutually liked each other. In particular, for each participant, we took the mean of 'dec_o' as a proxy for desireable-ness.



We defined a new table 'rest_of' (TODO: give better name) which represents the constant attributes of the participants. For example, from one date to another your age, field of study, and gender do not change. We wanted to see whether we can predict desirable-ness.

```{r}

first <- aggregate(dec_o ~ iid,data1, mean)

rest_of <- data1[, c("iid","gender","age", "field_cd", "mn_sat", "tuition", "imprace", "income", "goal", "date", "go_out", "career_c", "match_es","sports", "tvsports", "exercise", "dining", "museums", "art", "hiking", "gaming", "clubbing", "reading", "tv", "theater", "movies", "concerts", "music", "shopping", "yoga")]

rest_of <- rest_of[!duplicated(rest_of),]

total <- merge(first,rest_of,by="iid")
str(total)

```


```{r}
total <- total[, -c(6,7,9) ]
fit <- lm(dec_o ~ ., data = na.omit(total))
summary(fit)


```

```{r}
# since we have a bunch of predictor variables I'm going to run a stepwaise AIC
library(MASS)
step <- stepAIC(fit, direction="both")
step$anova # display results
```

```{r}
fit2 <- lm(dec_o ~ gender + age + field_cd + go_out + sports + tvsports + 
    exercise + art + clubbing + tv + theater, data = na.omit(total))
summary(fit2)
```


```{r}
pairs(total[,c("dec_o", "gender", "age", "field_cd", "go_out", "sports", "tvsports", "exercise", "art", "clubbing", "tv", "theater")])

#that didn't do shite
par(mfrow = c(2,2))
plot(fit2)

```


